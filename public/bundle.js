(()=>{"use strict";const e=25,t=["cyan","blue","orange","yellow","green","purple","red"],i="ArrowLeft",s="ArrowRight",r="ArrowUp",n="ArrowDown",c=[[[[0,0,0,0,0],[0,0,0,0,0],[0,0,2,1,0],[0,0,1,1,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,0,0,0,0],[0,0,2,1,0],[0,0,1,1,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,0,0,0,0],[0,0,2,1,0],[0,0,1,1,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,0,0,0,0],[0,0,2,1,0],[0,0,1,1,0],[0,0,0,0,0]]],[[[0,0,0,0,0],[0,0,0,0,0],[0,1,2,1,1],[0,0,0,0,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,0,1,0,0],[0,0,2,0,0],[0,0,1,0,0],[0,0,1,0,0]],[[0,0,0,0,0],[0,0,0,0,0],[1,1,2,1,0],[0,0,0,0,0],[0,0,0,0,0]],[[0,0,1,0,0],[0,0,1,0,0],[0,0,2,0,0],[0,0,1,0,0],[0,0,0,0,0]]],[[[0,0,0,0,0],[0,0,1,0,0],[0,0,2,0,0],[0,0,1,1,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,0,0,0,0],[0,1,2,1,0],[0,1,0,0,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,1,1,0,0],[0,0,2,0,0],[0,0,1,0,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,0,0,1,0],[0,1,2,1,0],[0,0,0,0,0],[0,0,0,0,0]]],[[[0,0,0,0,0],[0,0,1,0,0],[0,0,2,0,0],[0,1,1,0,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,1,0,0,0],[0,1,2,1,0],[0,0,0,0,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,0,1,1,0],[0,0,2,0,0],[0,0,1,0,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,0,0,0,0],[0,1,2,1,0],[0,0,0,1,0],[0,0,0,0,0]]],[[[0,0,0,0,0],[0,0,0,1,0],[0,0,2,1,0],[0,0,1,0,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,0,0,0,0],[0,1,2,0,0],[0,0,1,1,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,0,1,0,0],[0,1,2,0,0],[0,1,0,0,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,1,1,0,0],[0,0,2,1,0],[0,0,0,0,0],[0,0,0,0,0]]],[[[0,0,0,0,0],[0,0,1,0,0],[0,0,2,1,0],[0,0,0,1,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,0,0,0,0],[0,0,2,1,0],[0,1,1,0,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,1,0,0,0],[0,1,2,0,0],[0,0,1,0,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,0,1,1,0],[0,1,2,0,0],[0,0,0,0,0],[0,0,0,0,0]]],[[[0,0,0,0,0],[0,0,1,0,0],[0,0,2,1,0],[0,0,1,0,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,0,0,0,0],[0,1,2,1,0],[0,0,1,0,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,0,1,0,0],[0,1,2,0,0],[0,0,1,0,0],[0,0,0,0,0]],[[0,0,0,0,0],[0,0,1,0,0],[0,1,2,1,0],[0,0,0,0,0],[0,0,0,0,0]]]],o=[[[-2,-2],[-2,-2],[-2,-2],[-2,-2]],[[-1,-2],[-2,-1],[0,-2],[-2,0]],[[-2,-1],[-1,-2],[-1,-1],[-1,-1]],[[-1,-1],[-1,-1],[-2,-1],[-1,-2]],[[-2,-1],[-1,-2],[-1,-1],[-1,-1]],[[-2,-1],[-2,-1],[-1,-1],[-1,-1]],[[-2,-1],[-1,-2],[-1,-1],[-1,-1]]];function l(e,t){return Math.floor(e+Math.random()*(t-e))}function h(e){return new d(e,l(0,c.length))}function a(e,t){return e[t].every((e=>0===e))}function u(e,t){return e[t].every((e=>0!==e))}class d{constructor(e,i){this.type=i,this.ctx=e,this.rotate=0,this.pieceArray=c[i][this.rotate],this.inicialPosition=o[this.type][this.rotate],this.colorCode=l(0,t.length),this.color=t[this.colorCode],this.row=0,this.column=5}rotatePiece(){this.rotate++,this.rotate>3&&(this.rotate=0),this.pieceArray=c[this.type][this.rotate],this.inicialPosition=o[this.type][this.rotate]}draw(){for(let t=0;t<this.pieceArray.length;t++)for(let i=0;i<5;i++)0!==this.pieceArray[t][i]&&(this.ctx.fillStyle=this.color,this.ctx.fillRect((this.column+i+this.inicialPosition[0])*e,(this.row+t+this.inicialPosition[1])*e,e,e))}}function P(e,t){t.row+=1;for(let i=0;i<t.pieceArray.length;i++)for(let s=0;s<5;s++){if(0===t.pieceArray[i][s])continue;let r=t.row+i+t.inicialPosition[1],n=t.column+s+t.inicialPosition[0];if(r>=e.length)return!0;if(0!==e[r][n])return!0}return!1}function f(e,t,i){t.column+=i;for(let i=0;i<t.pieceArray.length;i++)for(let s=0;s<5;s++){if(0===t.pieceArray[i][s])continue;let r=t.row+i+t.inicialPosition[1],n=t.column+s+t.inicialPosition[0];if(n>=10||n<0)return!0;if(0!==e[r][n])return!0}return!1}const y=document.getElementById("music-toggle"),m=document.getElementById("icon-music");let p=!1,g=new Audio("./assets/tetris.mp3");g.loop=!0,y.addEventListener("click",(e=>{p=!p,m.className=p?"fas fa-volume-up":"fas fa-volume-mute",p?g.play():g.pause()}));const x=document.querySelector(".modal-back"),w=new class{constructor(){this.ctx=document.getElementById("scene").getContext("2d"),this.scoreDisplay=document.getElementById("score"),this.levelDisplay=document.getElementById("level"),this.nextDisplay=document.getElementById("next-piece").getContext("2d"),this.keysPressed={left:!1,right:!1,up:!1,down:!1},this.board=Array.from({length:20},(e=>Array.from({length:10},(e=>0)))),this.gameOver=!1,this.score=0,this.level=1,this.timerate=800,this.timePassed=0,this.currentPiece=h(this.ctx),this.currentPiece.column=5,this.nextPiece=h(this.nextDisplay),this.nextPiece.column=0,this.updateNextPiece()}update(e){if(this.keysPressed.left&&(f(this.board,Object.assign({},this.currentPiece),-1)||(this.currentPiece.column+=-1),this.keysPressed.left=!1),this.keysPressed.right&&(f(this.board,Object.assign({},this.currentPiece),1)||(this.currentPiece.column+=1),this.keysPressed.right=!1),this.keysPressed.up&&(function(e,t){t.__proto__=d.prototype,t.rotatePiece();for(let i=0;i<t.pieceArray.length;i++)for(let s=0;s<5;s++){if(0===t.pieceArray[i][s])continue;let r=t.row+i+t.inicialPosition[1],n=t.column+s+t.inicialPosition[0];if(n>=10||n<0)return!0;if(0!==e[r][n])return!0}return!1}(this.board,Object.assign({},this.currentPiece))||this.currentPiece.rotatePiece(),this.keysPressed.up=!1),this.keysPressed.down&&(P(this.board,Object.assign({},this.currentPiece))?(this.fillingPiece(),this.clearFullLines(),this.currentPiece=this.nextPiece,this.currentPiece.ctx=this.ctx,this.nextPiece=h(this.nextDisplay),this.nextPiece.column=0,this.updateNextPiece()):this.currentPiece.row+=1,this.keysPressed.down=!1),this.timePassed+=e,this.timePassed>=this.timerate){if(function(e,t){for(let i=0;i<t.pieceArray.length;i++)for(let s=0;s<5;s++){if(0===t.pieceArray[i][s])continue;let r=t.row+i+t.inicialPosition[1],n=t.column+s+t.inicialPosition[0];if(0!==e[r][n])return!0}return!1}(this.board,Object.assign({},this.currentPiece)))return void(this.gameOver=!0);P(this.board,Object.assign({},this.currentPiece))?(this.fillingPiece(),this.clearFullLines(),this.currentPiece=this.nextPiece,this.currentPiece.ctx=this.ctx,this.nextPiece=h(this.nextDisplay),this.nextPiece.column=0,this.updateNextPiece()):this.currentPiece.row+=1,this.timePassed=0}}fillingPiece(){for(let e=0;e<this.currentPiece.pieceArray.length;e++)for(let t=0;t<5;t++){if(0===this.currentPiece.pieceArray[e][t])continue;let i=this.currentPiece.column+t+this.currentPiece.inicialPosition[0],s=this.currentPiece.row+e+this.currentPiece.inicialPosition[1];this.board[s][i]=this.currentPiece.colorCode+1}}clearFullLines(){for(let e=19;e>=0&&!a(this.board,e);e--)if(u(this.board,e)){this.score+=10;let t=e,i=e-1;for(;i>0||!a(this.board,i);)this.board[t]=[...this.board[i]],this.board[i]=Array.from({length:10},(e=>0)),u(this.board,t)?this.score+=10:t--,i--}this.updateScore()}updateScore(){this.scoreDisplay.innerText=this.score,0!==this.score&&this.score%200==0&&this.level<13&&(this.score+=1,this.level++,this.timerate-=50,this.levelDisplay.innerText=this.level)}updateNextPiece(){this.nextDisplay.fillStyle="#30272a",this.nextDisplay.fillRect(0,0,125,125),this.nextPiece.draw()}draw(){this.ctx.fillStyle="#30272a",this.ctx.fillRect(0,0,250,500),this.currentPiece.draw();for(let i=19;i>=0&&!a(this.board,i);i--)for(let s=0;s<10;s++)0!==this.board[i][s]&&(this.ctx.fillStyle=t[this.board[i][s]-1],this.ctx.fillRect(s*e,i*e,e,e))}};let b=0,A=0,k=1e3/60,v=!1,D=!1,E=0;function O(e){if(e<b+1e3/60)return void(E=requestAnimationFrame(O));A+=e-b,b=e;let t=0;for(;A>=k;)if(w.update(k),A-=k,++t>=240){A=0;break}if(w.gameOver)return v=!1,D=!1,cancelAnimationFrame(E),void(x.style.display="flex");w.draw(),E=requestAnimationFrame(O)}D||(D=!0,E=requestAnimationFrame((function(e){w.draw(),v=!0,b=e,E=requestAnimationFrame(O)}))),window.addEventListener("keydown",(e=>{let t=e.code;t===i&&(w.keysPressed.left=!0),t===s&&(w.keysPressed.right=!0),t===r&&(w.keysPressed.up=!0),t===n&&(w.keysPressed.down=!0)})),window.addEventListener("keyup",(e=>{let t=e.code;t===i&&(w.keysPressed.left=!1),t===s&&(w.keysPressed.right=!1),t===r&&(w.keysPressed.up=!1),t===n&&(w.keysPressed.down=!1)}))})();
//# sourceMappingURL=bundle.js.map